{"version":3,"sources":["app/data-context-blog.js"],"names":["factory","define","req","url","_","auth","_createViewLink","id","_createEditLink","_normalizeBlog","blog","authenticated","hasBeenUpdated","modified","created","hasLabels","labels","viewLink","editLink","_getBlogSummaries","uri","get","resolveApi","then","data","map","item","summary","title","body","displayDate","showInResults","console","log","blogs","getSummaries","label","size","page","showHidden","push","join","getById","getDefault","update","args","put","updateListed","listed","create","post"],"mappings":"AAAA,cAEA,SAAWA,GAIe,kBAAXC,SAAyBA,OAAY,KAC5CA,QAAQ,cAAe,UAAW,aAAc,YAAaD,IAElE,SAAUE,EAAKC,EAAKC,EAAGC,GAgDtB,QAASC,GAAgBC,GACrB,MAAO,SAAWA,EAGtB,QAASC,GAAgBD,GACrB,MAAO,cAAgBA,EAG3B,QAASE,GAAeC,GAEpB,GAAIC,GAAgBN,EAAKM,eAUzB,OARAD,GAAKE,eAAiBF,EAAKG,UAAYH,EAAKI,QAC5CJ,EAAKK,YAAcL,EAAKM,OACxBN,EAAKO,SAAWX,EAAgBI,EAAKH,IAEjCI,IACAD,EAAKQ,SAAWV,EAAgBE,EAAKH,KAGlCG,EAGX,QAASS,GAAkBC,GAEvB,MAAOlB,GAAImB,IAAIlB,EAAImB,WAAWF,IAAMG,KAAK,SAAUC,GAE/C,GAAIb,GAAgBN,EAAKM,eAGzB,OAAOP,GAAEoB,GAAMC,IAAI,SAAUC,GAEzB,GAAIC,IACApB,GAAImB,EAAKnB,GACTqB,MAAOF,EAAKE,MACZC,KAAMH,EAAKC,QAAUD,EAAKC,QAAU,MAAQ,GAC5CV,SAAUX,EAAgBoB,EAAKnB,IAC/BuB,YAAaJ,EAAKb,UAAYa,EAAKZ,QAAUY,EAAKb,SAAWa,EAAKZ,QAClEiB,cAAeL,EAAKK,cAOxB,OAJIpB,KACAgB,EAAQT,SAAWV,EAAgBkB,EAAKnB,KAGrCoB,MAzFnBK,QAAQC,IAAI,mBAEZ,IAAIC,IACAC,aAAc,SAAsBC,EAAOC,EAAMC,EAAMC,GAEnD,GAAInB,IAAO,0BAA2BiB,GAAQ,GAAI,SAAUC,GAAQ,EAUpE,OARIF,IACAhB,EAAIoB,KAAK,UAAWJ,GAGpBG,GACAnB,EAAIoB,KAAK,gBAGNrB,EAAkBC,EAAIqB,KAAK,MAEtCC,QAAS,SAAiBnC,GAEtB,MAAOL,GAAImB,IAAIlB,EAAImB,WAAW,aAAcf,IAAKgB,KAAKd,IAE1DkC,WAAY,WAER,MAAOzC,GAAImB,IAAIlB,EAAImB,WAAW,uBAElCsB,OAAQ,SAAgBC,GAEpB,MAAO3C,GAAI4C,IAAI3C,EAAImB,WAAW,aAAcuB,EAAKtC,IAAKsC,IAE1DE,aAAc,SAAsBxC,EAAIyC,GAEpC,MAAO9C,GAAI4C,IAAI3C,EAAImB,WAAW,aAAcf,EAAI,YAAcA,GAAIA,EAAIyC,OAAQA,KAGlFC,OAAQ,SAAgBJ,GAEpB,MAAO3C,GAAIgD,KAAK/C,EAAImB,WAAW,aAAcuB,IAIrD,QACIX,MAAOA","file":"app/data-context-blog.js","sourcesContent":["'use strict';\n\n(function (factory) {\n\n    \"use strict\";\n\n    if (typeof define === 'function' && define['amd']) {\n        define(['lib/request', 'lib/url', 'underscore', 'lib/auth'], factory);\n    }\n})(function (req, url, _, auth) {\n\n    \"use strict\";\n\n    console.log('app/data-context');\n\n    var blogs = {\n        getSummaries: function getSummaries(label, size, page, showHidden) {\n\n            var uri = ['/api/blog/summary?size=', size || 20, '&page=', page || 0];\n\n            if (label) {\n                uri.push('&label=', label);\n            }\n\n            if (showHidden) {\n                uri.push(\"&hidden=true\");\n            }\n\n            return _getBlogSummaries(uri.join(''));\n        },\n        getById: function getById(id) {\n\n            return req.get(url.resolveApi('/api/blog/', id)).then(_normalizeBlog);\n        },\n        getDefault: function getDefault() {\n\n            return req.get(url.resolveApi('/api/blog/default'));\n        },\n        update: function update(args) {\n\n            return req.put(url.resolveApi('/api/blog/', args.id), args);\n        },\n        updateListed: function updateListed(id, listed) {\n\n            return req.put(url.resolveApi('/api/blog/', id, '/listed'), { id: id, listed: listed });\n        },\n\n        create: function create(args) {\n\n            return req.post(url.resolveApi('/api/blog'), args);\n        }\n    };\n\n    return {\n        blogs: blogs\n    };\n\n    function _createViewLink(id) {\n        return '#blog/' + id;\n    }\n\n    function _createEditLink(id) {\n        return '#blog/edit/' + id;\n    }\n\n    function _normalizeBlog(blog) {\n\n        var authenticated = auth.authenticated();\n\n        blog.hasBeenUpdated = blog.modified != blog.created;\n        blog.hasLabels = !!blog.labels;\n        blog.viewLink = _createViewLink(blog.id);\n\n        if (authenticated) {\n            blog.editLink = _createEditLink(blog.id);\n        }\n\n        return blog;\n    }\n\n    function _getBlogSummaries(uri) {\n\n        return req.get(url.resolveApi(uri)).then(function (data) {\n\n            var authenticated = auth.authenticated();\n\n            // Just clean up the display information specifically for this app\n            return _(data).map(function (item) {\n\n                var summary = {\n                    id: item.id,\n                    title: item.title,\n                    body: item.summary ? item.summary + '...' : '',\n                    viewLink: _createViewLink(item.id),\n                    displayDate: item.modified != item.created ? item.modified : item.created,\n                    showInResults: item.showInResults\n                };\n\n                if (authenticated) {\n                    summary.editLink = _createEditLink(item.id);\n                }\n\n                return summary;\n            });\n        });\n    }\n});"],"sourceRoot":"/source/"}