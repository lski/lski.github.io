{"version":3,"sources":["app/stores/contents-store.js"],"names":["dispatcher","constants","MicroEvent","folderStore","ctx","assign","Object","contentsStore","_reloadContents","folder","getSelected","getFolderContents","path","then","data","set","_dispatch","evt","action","FOLDERS_LOADED","waitFor","dispatchToken","SELECTED_ITEM_CHANGED","setSelectedItem","SELECTED_FOLDER_CHANGED","NEW_ITEM_ADDED","ITEM_DELETED","_contents","_selected","_events","_dispatchToken","register","mixin","get","contents","trigger","CHANGE","item","addListener","handler","bind","removeListener","unbind"],"mappings":"AAAA,YAEA,IAAIA,YAAaA,WACbC,UAAYA,UACZC,WAAaA,WACbC,YAAcA,YACdC,IAAMA,IACNC,OAASC,OAAOD,OAEhBE,cAAgB,WAwCnB,QAASC,KACR,GAAIC,GAASN,YAAYO,aACrBD,IACHL,IAAIO,kBAAkBF,EAAOG,MAAMC,KAAK,SAAUC,GACjDP,cAAcQ,IAAID,KAKrB,QAASE,GAAUC,GAElB,OAAQA,EAAIC,QAEX,IAAKjB,WAAUkB,eACdnB,WAAWoB,SAASjB,YAAYkB,gBAChCb,GACA,MAED,KAAKP,WAAUqB,sBACdf,cAAcgB,gBAAgBN,EAAIH,KAClC,MAED,KAAKb,WAAUuB,wBACdxB,WAAWoB,SAASjB,YAAYkB,gBAChCb,GAEA,MAED,KAAKP,WAAUwB,eACdjB,GACA,MAED,KAAKP,WAAUyB,aACdlB,KAvEH,GAAImB,MACAC,EAAY,KACZC,KACAC,EAAiB9B,WAAW+B,SAASf,EAIzC,OAFAd,YAAW8B,MAAMH,IAGhBR,cAAeS,EACfG,IAAK,WACJ,MAAON,IAERjB,YAAa,WACZ,MAAOkB,IAERb,IAAK,SAAamB,GACjBP,EAAYO,EACZN,EAAY,KACZC,EAAQM,QAAQlC,UAAUmC,SAE3Bb,gBAAiB,SAAyBc,GAErCT,GAAaS,IAChBT,EAAYvB,UAAWgC,GACvBR,EAAQM,QAAQlC,UAAUmC,UAG5BD,QAAS,WACRN,EAAQM,QAAQlC,UAAUmC,SAE3BE,YAAa,SAAqBC,GACjCV,EAAQW,KAAKvC,UAAUmC,OAAQG,IAEhCE,eAAgB,SAAwBF,GACvCV,EAAQa,OAAOzC,UAAUmC,OAAQG","file":"app/stores/contents-store.js","sourcesContent":["\"use strict\";\n\nvar dispatcher = dispatcher;\nvar constants = constants;\nvar MicroEvent = MicroEvent;\nvar folderStore = folderStore;\nvar ctx = ctx;\nvar assign = Object.assign;\n\nvar contentsStore = function () {\n\n\tvar _contents = [],\n\t    _selected = null,\n\t    _events = {},\n\t    _dispatchToken = dispatcher.register(_dispatch);\n\n\tMicroEvent.mixin(_events);\n\n\treturn {\n\t\tdispatchToken: _dispatchToken,\n\t\tget: function get() {\n\t\t\treturn _contents;\n\t\t},\n\t\tgetSelected: function getSelected() {\n\t\t\treturn _selected;\n\t\t},\n\t\tset: function set(contents) {\n\t\t\t_contents = contents;\n\t\t\t_selected = null;\n\t\t\t_events.trigger(constants.CHANGE);\n\t\t},\n\t\tsetSelectedItem: function setSelectedItem(item) {\n\n\t\t\tif (_selected != item) {\n\t\t\t\t_selected = assign({}, item);\n\t\t\t\t_events.trigger(constants.CHANGE);\n\t\t\t}\n\t\t},\n\t\ttrigger: function trigger() {\n\t\t\t_events.trigger(constants.CHANGE);\n\t\t},\n\t\taddListener: function addListener(handler) {\n\t\t\t_events.bind(constants.CHANGE, handler);\n\t\t},\n\t\tremoveListener: function removeListener(handler) {\n\t\t\t_events.unbind(constants.CHANGE, handler);\n\t\t}\n\t};\n\n\tfunction _reloadContents() {\n\t\tvar folder = folderStore.getSelected();\n\t\tif (folder) {\n\t\t\tctx.getFolderContents(folder.path).then(function (data) {\n\t\t\t\tcontentsStore.set(data);\n\t\t\t});\n\t\t}\n\t}\n\n\tfunction _dispatch(evt) {\n\n\t\tswitch (evt.action) {\n\n\t\t\tcase constants.FOLDERS_LOADED:\n\t\t\t\tdispatcher.waitFor([folderStore.dispatchToken]);\n\t\t\t\t_reloadContents();\n\t\t\t\tbreak;\n\n\t\t\tcase constants.SELECTED_ITEM_CHANGED:\n\t\t\t\tcontentsStore.setSelectedItem(evt.data);\n\t\t\t\tbreak;\n\n\t\t\tcase constants.SELECTED_FOLDER_CHANGED:\n\t\t\t\tdispatcher.waitFor([folderStore.dispatchToken]);\n\t\t\t\t_reloadContents();\n\n\t\t\t\tbreak;\n\n\t\t\tcase constants.NEW_ITEM_ADDED:\n\t\t\t\t_reloadContents();\n\t\t\t\tbreak;\n\n\t\t\tcase constants.ITEM_DELETED:\n\t\t\t\t_reloadContents();\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t// Nothing\n\t\t}\n\t}\n}();"],"sourceRoot":"/source/"}