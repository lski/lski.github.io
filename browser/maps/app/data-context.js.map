{"version":3,"sources":["app/data-context.js"],"names":["request","lski","DataContext","apiUrl","token","resolveApi","path","_root","cb","options","headers","dataOnly","this","deleteItem","id","del","getFolderContents","folderPath","get","window","encodeURIComponent","then","response","map","item","isFile","isImage","icon","link","getFolderTree"],"mappings":"AAAA,YAEA,IAAIA,SAAUC,KAAKD,QAEfE,YAAc,WAEjB,MAAO,UAAqBC,EAAQC,GAmBnC,QAASC,GAAWC,GACnB,MAAOC,GAAQD,EAlBhB,GAAIC,GAAQJ,CAERC,KACH,WAEC,GAAII,GAAsB,kBAAVJ,GAAuBA,EAAQ,WAC9C,MAAOA,GAGRJ,SAAQS,QAAQC,QAAuB,cAAI,WAC1C,MAAO,UAAYF,QAKtBR,QAAQS,QAAQE,UAAW,EAM3BC,KAAKC,WAAa,SAAUC,GAE3B,MAAOd,SAAQe,IAAIV,EAAW,qBAAuBS,KAGtDF,KAAKI,kBAAoB,SAAUC,GAElC,MAAOjB,SAAQkB,IAAIb,EAAW,qCAAuCc,OAAOC,mBAAmBH,KAAcI,KAAK,SAAUC,GAE3H,MAAOA,GAASC,IAAI,SAAUC,GAU7B,MARIA,GAAKC,QAAUD,EAAKE,QACvBF,EAAKG,KAAOH,EAAKI,KACPJ,EAAKC,OACfD,EAAKG,KAAO,qCAEZH,EAAKG,KAAO,iCAGNH,OAKVZ,KAAKiB,cAAgB,WACpB,MAAO7B,SAAQkB,IAAIb,EAAW,yBAG/BO,KAAKP,WAAaA","file":"app/data-context.js","sourcesContent":["\"use strict\";\n\nvar request = lski.request;\n\nvar DataContext = function () {\n\n\treturn function DataContext(apiUrl, token) {\n\n\t\tvar _root = apiUrl;\n\n\t\tif (token) {\n\t\t\t(function () {\n\n\t\t\t\tvar cb = typeof token === \"function\" ? token : function () {\n\t\t\t\t\treturn token;\n\t\t\t\t};\n\n\t\t\t\trequest.options.headers[\"Authorization\"] = function () {\n\t\t\t\t\treturn \"Bearer \" + cb();\n\t\t\t\t};\n\t\t\t})();\n\t\t}\n\n\t\trequest.options.dataOnly = true;\n\n\t\tfunction resolveApi(path) {\n\t\t\treturn _root + path;\n\t\t}\n\n\t\tthis.deleteItem = function (id) {\n\n\t\t\treturn request.del(resolveApi('/api/browser/file/' + id));\n\t\t};\n\n\t\tthis.getFolderContents = function (folderPath) {\n\n\t\t\treturn request.get(resolveApi('/api/browser/folder/contents?path=' + window.encodeURIComponent(folderPath))).then(function (response) {\n\n\t\t\t\treturn response.map(function (item) {\n\n\t\t\t\t\tif (item.isFile && item.isImage) {\n\t\t\t\t\t\titem.icon = item.link;\n\t\t\t\t\t} else if (item.isFile) {\n\t\t\t\t\t\titem.icon = 'content/images/blank-file-icon.png';\n\t\t\t\t\t} else {\n\t\t\t\t\t\titem.icon = 'content/images/folder-icon.png';\n\t\t\t\t\t}\n\n\t\t\t\t\treturn item;\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\n\t\tthis.getFolderTree = function () {\n\t\t\treturn request.get(resolveApi('/api/browser/folder'));\n\t\t};\n\n\t\tthis.resolveApi = resolveApi;\n\t};\n}();"],"sourceRoot":"/source/"}